<?xml version="1.0"?>

<project name="Application Layer Nightly Build Script" default="post_build_tasks">
	<property environment="env"/>
    <property name="config_destination" value="${env.JBOSS_HOME}/server/cspace/conf" />
	<property name="app_trunk" location=".." />

	<target name="post_build_tasks" description="Various post-build tasks">
	  <antcall target="deploy_cspace_config"/>
	  <antcall target="retrieve_jar"/>
	</target>

	<target name="deploy_cspace_config" description="Copies the war and xml file to their locations">
		<copy todir="${config_destination}/tenants">
			<fileset dir="${app_trunk}/tomcat-main/src/main/resources/tenants/" includes="**"/>
		</copy>
		<copy todir="${config_destination}/defaults">
			<fileset dir="${app_trunk}/tomcat-main/src/main/resources/defaults/" includes="**"/>
		</copy>

		<copy file="${app_trunk}/tomcat-main/src/main/resources/tenants/core/nightly-settings.xml" tofile="${config_destination}/tenants/core/local-settings.xml" />
		<copy file="${app_trunk}/tomcat-main/src/main/resources/tenants/lifesci/nightly-settings.xml" tofile="${config_destination}/tenants/lifesci/local-settings.xml" />
	      
		<copy file="${app_trunk}/tomcat-main/src/main/resources/core-tenant.xml" tofile="${config_destination}/cspace-config-core.xml" />
		<copy file="${app_trunk}/tomcat-main/src/main/resources/lifesci-tenant.xml" tofile="${config_destination}/cspace-config-lifesci.xml" />
	</target>

	<target name="retrieve_jar" description="Retrieves the JAR for command-line use">
		<copy file="${app_trunk}/tomcat-main/target/tomcat-main.one-jar.jar" tofile="${config_destination}/cspace.jar" />
	</target>

</project>

